Simulations:
- name: sim1
  optimizer: opt1
  time_integrator: ti_1

# Hypre memory and other configurations
hypre_config:
  umpire_device_pool_mbs: 4096
  use_vendor_spgemm: 1
  use_vendor_spmv: 0
  use_vendor_sptrans: 0

Time_Integrators:
- StandardTimeIntegrator:
    name: ti_1
    realms:
    - realm_1
    second_order_accuracy: true
    start_time: 0
    termination_step_count: 50000
    time_step: 0.0002667
    time_step_count: 0
    time_stepping_type: fixed

linear_solvers:
  # solver for the momentum
  - name: solve_mom
    type: hypre
    method: hypre_gmres
    preconditioner: boomerAMG
    tolerance: 1e-5
    max_iterations: 1000
    kspace: 1000
    sync_alg: 1
    output_level: 0
    write_matrix_files: no
    #write_preassembly_matrix_files: yes
    recompute_preconditioner_frequency: 1
    reuse_linear_system: yes
    simple_hypre_matrix_assemble: yes
    dump_hypre_matrix_stats: no
    segregated_solver: yes
    hypre_cfg_file: hypre_file.yaml
    hypre_cfg_node: hypre_simple_precon

  # solver for the scalars TKE, SDR
  - name: solve_scalar
    type: hypre
    method: hypre_gmres
    preconditioner: boomerAMG
    tolerance: 1e-5
    max_iterations: 1000
    kspace: 1000
    sync_alg: 1
    output_level: 0
    write_matrix_files: no
    #write_preassembly_matrix_files: yes
    recompute_preconditioner_frequency: 1
    reuse_linear_system: yes
    simple_hypre_matrix_assemble: yes
    dump_hypre_matrix_stats: no
    hypre_cfg_file: hypre_file.yaml
    hypre_cfg_node: hypre_simple_precon

  # solver for the pressure
  - name: solve_elliptic
    type: hypre
    method: hypre_gmres
    preconditioner: boomerAMG
    tolerance: 1e-5
    max_iterations: 1000
    kspace: 1000
    sync_alg: 1
    output_level: 0
    write_matrix_files: no
    #write_preassembly_matrix_files: yes
    recompute_preconditioner_frequency: 1
    reuse_linear_system: yes
    simple_hypre_matrix_assemble: yes
    dump_hypre_matrix_stats: no
    hypre_cfg_file: hypre_file.yaml
    hypre_cfg_node: hypre_elliptic

realms:
- mesh: mesh/ffaw3211_3d_aoa50_periodic_overset.exo
  automatic_decomposition_type: rcb
  rebalance_mesh: yes
  stk_rebalance_method: parmetis
  check_jacobians: true
    
  boundary_conditions:
  - target_name: airfoil
    wall_boundary_condition: bc_wing
    wall_user_data:
      turbulent_ke: 0.0
      use_wall_function: false
      velocity:
      - 0
      - 0
      - 0
  - inflow_boundary_condition: bc_inflow
    target_name: inflow
    inflow_user_data:
      specific_dissipation_rate: 2266.4
      turbulent_ke: 0.095118
      velocity:
      - 15.0
      - 0.0
      - 0.0
    
  - open_boundary_condition: bc_open
    target_name: outflow
    open_user_data:
      pressure: 0.0
      specific_dissipation_rate: 2266.4
      turbulent_ke: 0.095118
      velocity:
      - 0.0
      - 0.0
      - 0.0

  - periodic_boundary_condition: bc_front_back
    target_name: [front-fluid, back-fluid]
    check_for_missing_bcs: true
    periodic_user_data:
      search_tolerance: 0.0001

  - periodic_boundary_condition: bc_front_back_af
    target_name: [front-airfoil, back-airfoil]
    check_for_missing_bcs: true
    periodic_user_data:
      search_tolerance: 0.0001

  - overset_boundary_condition: bc_overset
    overset_connectivity_type: tioga
    overset_user_data:
      tioga_options:
        symmetry_direction: 2
        set_resolutions: no
      mesh_group:
      - overset_name: airfoil
        mesh_parts:
        - airfoil-HEX
        wall_parts: [airfoil]
        ovset_parts: [outerBCairfoil]
      - overset_name: static
        mesh_parts:
        - fluid-HEX

  equation_systems:
    max_iterations: 4
    name: theEqSys
    decoupled_overset_solve: true

    solver_system_specification:
      velocity: solve_mom
      turbulent_ke: solve_scalar
      specific_dissipation_rate: solve_scalar
      pressure: solve_elliptic
      ndtw: solve_elliptic

    systems:
    - WallDistance:
        convergence_tolerance: 1.0e-08
        max_iterations: 1
        name: myNDTW
    - LowMachEOM:
        convergence_tolerance: 1.0e-08
        max_iterations: 1
        name: myLowMach
    - ShearStressTransport:
        convergence_tolerance: 1.0e-08
        max_iterations: 1
        name: mySST

  initial_conditions:
    - constant: ic_1
      target_name: [fluid-HEX, airfoil-HEX]
      value:
        pressure: 0
        velocity: [15.0, 0.0, 0.0]
        turbulent_ke: 0.095118
        specific_dissipation_rate: 2266.4
        minimum_distance_to_wall: 8.0

  material_properties:
    specifications:
    - name: density
      type: constant
      value: 1.2
    - name: viscosity
      type: constant
      value: 9.0e-06
    target_name: [fluid-HEX, airfoil-HEX]
  name: realm_1
  output:
    output_data_base_name: results/pitchingAF_field_val1cumulative.e
    output_frequency: 100
    output_node_set: false
    output_variables:
    - velocity
    - density
    - pressure
    - pressure_force
    - viscous_force
    - tau_wall_vector
    - tau_wall
    - turbulent_ke
    - specific_dissipation_rate
    - minimum_distance_to_wall
    - sst_f_one_blending
    - turbulent_viscosity
    - element_courant
    - q_criterion
    - vorticity
    - assembled_area_force_moment


  mesh_transformation:
  - mesh_parts:
    - airfoil-HEX
    motion:
    - angle: 40.0
      axis:
      - 0.0
      - 0.0
      - 1.0
      centroid:
      - 0.0
      - 0.0
      - 0.0
      type: rotation
    name: angle_of_attack

  mesh_motion:
  - name: arbitrary_motion_airfoil
    mesh_parts: 
    - airfoil-HEX
    frame: non_inertial
    motion:
    - type: rotation
      angle: 0.08765865048345224
      start_time: 1.0e-6
      end_time: 0.2727891156462585
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 3.8232149547437104
      start_time: 0.2727901156462585
      end_time: 0.545578231292517
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 3.2255492616581614
      start_time: 0.5455792312925171
      end_time: 0.8183673469387756
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 2.13815191124449
      start_time: 0.8183683469387756
      end_time: 1.091156462585034
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 0.7253330001780203
      start_time: 1.091157462585034
      end_time: 1.3639455782312926
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -0.7977143259792214
      start_time: 1.3639465782312925
      end_time: 1.636734693877551
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -2.1991034949807187
      start_time: 1.636735693877551
      end_time: 1.9095238095238094
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -3.265522172680041
      start_time: 1.9095248095238093
      end_time: 2.182312925170068
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -3.83505694206894
      start_time: 2.1823139251700683
      end_time: 2.455102040816327
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -3.8195084726768256
      start_time: 2.455103040816327
      end_time: 2.727891156462585
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -3.2234568090632965
      start_time: 2.7278921564625853
      end_time: 3.0006802721088435
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -2.1360699413774373
      start_time: 3.0006812721088436
      end_time: 3.273469387755102
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -0.723214495033
      start_time: 3.2734703877551024
      end_time: 3.546258503401361
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 0.8000493825469057
      start_time: 3.546259503401361
      end_time: 3.819047619047619
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 2.2017703987304884
      start_time: 3.819048619047619
      end_time: 4.091836734693878
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 3.268387761177852
      start_time: 4.091837734693878
      end_time: 4.364625850340136
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 3.8360977613939053
      start_time: 4.364626850340136
      end_time: 4.637414965986395
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 3.8214051397112554
      start_time: 4.637415965986395
      end_time: 4.910204081632654
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 3.221515714601306
      start_time: 4.910205081632654
      end_time: 5.182993197278911
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 2.1320694186095226
      start_time: 5.182994197278911
      end_time: 5.45578231292517
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 0.7181320206360429
      start_time: 5.4557833129251705
      end_time: 5.728571428571429
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -0.8049233663834432
      start_time: 5.728572428571429
      end_time: 6.001360544217687
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -2.2052043249544795
      start_time: 6.001361544217687
      end_time: 6.274149659863946
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -3.269568173936971
      start_time: 6.274150659863946
      end_time: 6.546938775510204
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -3.8360000769982814
      start_time: 6.546939775510205
      end_time: 6.819727891156463
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -3.8183985849728415
      start_time: 6.819728891156463
      end_time: 7.092517006802722
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -3.219273753369115
      start_time: 7.092518006802722
      end_time: 7.365306122448979
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -2.1298863776655654
      start_time: 7.3653071224489794
      end_time: 7.638095238095238
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -0.7159923549459482
      start_time: 7.638096238095238
      end_time: 7.910884353741497
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 0.8071905075229733
      start_time: 7.910885353741497
      end_time: 8.183673469387756
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 2.207729437012371
      start_time: 8.183674469387755
      end_time: 8.456462585034014
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 3.272254835140304
      start_time: 8.456463585034014
      end_time: 8.729251700680273
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 3.8378856931096794
      start_time: 8.729252700680272
      end_time: 9.00204081632653
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 3.819529496958513
      start_time: 9.00204181632653
      end_time: 9.27482993197279
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 3.217479448439316
      start_time: 9.274830931972788
      end_time: 9.547619047619047
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 2.1259876312596564
      start_time: 9.547620047619047
      end_time: 9.820408163265308
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 0.7109348146491019
      start_time: 9.820409163265307
      end_time: 10.093197278911564
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -0.8121260591476851
      start_time: 10.093198278911563
      end_time: 10.365986394557822
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -2.211296804492493
      start_time: 10.365987394557822
      end_time: 10.638775510204082
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -3.2736044290389
      start_time: 10.638776510204082
      end_time: 10.91156462585034
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -3.8369308347920015
      start_time: 10.91156562585034
      end_time: 11.184353741496599
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -3.81727989611811
      start_time: 11.184354741496598
      end_time: 11.457142857142857
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -3.2150805499026514
      start_time: 11.457143857142857
      end_time: 11.729931972789116
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -2.1236938469957636
      start_time: 11.729932972789115
      end_time: 12.002721088435374
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: -0.7087631089665472
      start_time: 12.002722088435373
      end_time: 12.275510204081634
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 0.8143362151641185
      start_time: 12.275511204081633
      end_time: 12.548299319727892
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 2.2136899421948657
      start_time: 12.548300319727892
      end_time: 12.821088435374149
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 3.2761198095943533
      start_time: 12.821089435374148
      end_time: 13.093877551020409
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]
    - type: rotation
      angle: 3.8396317519641023
      start_time: 13.093878551020408
      end_time: 13.366666666666667
      axis: [0.0, 0.0, 1.0]
      origin: [0.0, 0.0, 0.0]

  post_processing:
  - frequency: 1
    output_file_name: results/pitchingAF_forces_val1cumulative.dat
    parameters:
    - 0
    - 0
    physics: surface_force_and_moment
    target_name:
    - airfoil
    type: surface
 
  restart:
    restart_data_base_name: restart/pitchingAF_val1cumulative.rst
    restart_frequency: 100
      #restart_time: 0.0912114 

  solution_options:
    name: myOptions
    options:
    - hybrid_factor:
        specific_dissipation_rate: 1.0
        turbulent_ke: 1.0
        velocity: 1.0
    - alpha_upw:
        specific_dissipation_rate: 1.0
        turbulent_ke: 1.0
        velocity: 1.0
    - upw_factor:
        specific_dissipation_rate: 0.0
        turbulent_ke: 0.0
        velocity: 1.0
    - limiter:
        pressure: true
        velocity: true
        turbulent_ke: true
        specific_dissipation_rate: true
    - noc_correction:
        pressure: true
    - projected_nodal_gradient:
        ndtw: element
        pressure: element
        specific_dissipation_rate: element
        turbulent_ke: element
        velocity: element
    - relaxation_factor:
        pressure: 0.3
        specific_dissipation_rate: 0.7
        turbulent_ke: 0.7
        velocity: 0.7
    - turbulence_model_constants:
        SDRWallFactor: 0.625
    projected_timescale_type: momentum_diag_inv
    turbulence_model: sst
  turbulence_averaging:
    specifications:
    - compute_q_criterion: true
      compute_vorticity: true
      name: one
      target_name: [fluid-HEX, airfoil-HEX]
    time_filter_interval: 100000.0
  use_edges: true

